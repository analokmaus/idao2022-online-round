2022-02-10 08:38:31.757301: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-02-10 08:38:33.918040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1525] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 20778 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:01:00.0, compute capability: 8.6
2022-02-10 08:38:45.971666: I tensorflow/stream_executor/cuda/cuda_blas.cc:1774] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
/home/hiroshi_yoshihara/.pyenv/versions/anaconda3-2020.02/envs/idao2022/lib/python3.8/site-packages/keras/optimizer_v2/adam.py:105: UserWarning: The `lr` argument is deprecated, use `learning_rate` instead.
  super(Adam, self).__init__(name, **kwargs)
INFO:megnet_models.callbacks:val mae: 0.45585 energy_within_threshold: 0.00337
INFO:megnet_models.callbacks:best mae: inf -> 0.45585
Epoch 1/300
19/19 - 37s - loss: 0.4687 - mae: 0.4666 - lr: 5.0000e-04 - 37s/epoch - 2s/step
/home/hiroshi_yoshihara/.pyenv/versions/anaconda3-2020.02/envs/idao2022/lib/python3.8/site-packages/keras/engine/functional.py:1410: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  layer_config = serialize_layer_fn(layer)
INFO:megnet_models.callbacks:val mae: 0.13047 energy_within_threshold: 0.07239
INFO:megnet_models.callbacks:best mae: 0.45585 -> 0.13047
Epoch 2/300
19/19 - 24s - loss: 0.3836 - mae: 0.3894 - lr: 5.0000e-04 - 24s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.12881 energy_within_threshold: 0.20370
INFO:megnet_models.callbacks:best mae: 0.13047 -> 0.12881
Epoch 3/300
19/19 - 23s - loss: 0.1505 - mae: 0.1500 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.12909 energy_within_threshold: 0.19360
Epoch 4/300
19/19 - 23s - loss: 0.1389 - mae: 0.1377 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.13636 energy_within_threshold: 0.19360
Epoch 5/300
19/19 - 23s - loss: 0.1368 - mae: 0.1365 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.10641 energy_within_threshold: 0.35859
INFO:megnet_models.callbacks:best mae: 0.12881 -> 0.10641
Epoch 6/300
19/19 - 23s - loss: 0.1284 - mae: 0.1279 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.10523 energy_within_threshold: 0.44949
INFO:megnet_models.callbacks:best mae: 0.10641 -> 0.10523
Epoch 7/300
19/19 - 23s - loss: 0.1223 - mae: 0.1228 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.11474 energy_within_threshold: 0.16330
Epoch 8/300
19/19 - 23s - loss: 0.1252 - mae: 0.1241 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.10099 energy_within_threshold: 0.24074
INFO:megnet_models.callbacks:best mae: 0.10523 -> 0.10099
Epoch 9/300
19/19 - 23s - loss: 0.1177 - mae: 0.1196 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.08786 energy_within_threshold: 0.41077
INFO:megnet_models.callbacks:best mae: 0.10099 -> 0.08786
Epoch 10/300
19/19 - 23s - loss: 0.1145 - mae: 0.1137 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.14693 energy_within_threshold: 0.00000
Epoch 11/300
19/19 - 23s - loss: 0.0928 - mae: 0.0920 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.09690 energy_within_threshold: 0.04209
Epoch 12/300
19/19 - 23s - loss: 0.1392 - mae: 0.1372 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.06629 energy_within_threshold: 0.02020
INFO:megnet_models.callbacks:best mae: 0.08786 -> 0.06629
Epoch 13/300
19/19 - 23s - loss: 0.0667 - mae: 0.0670 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.03820 energy_within_threshold: 0.42929
INFO:megnet_models.callbacks:best mae: 0.06629 -> 0.03820
Epoch 14/300
19/19 - 23s - loss: 0.0521 - mae: 0.0518 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.04357 energy_within_threshold: 0.25084
Epoch 15/300
19/19 - 23s - loss: 0.0388 - mae: 0.0389 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.04842 energy_within_threshold: 0.21717
Epoch 16/300
19/19 - 23s - loss: 0.0386 - mae: 0.0384 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.05484 energy_within_threshold: 0.21380
Epoch 17/300
19/19 - 23s - loss: 0.0533 - mae: 0.0539 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.03272 energy_within_threshold: 0.39057
INFO:megnet_models.callbacks:best mae: 0.03820 -> 0.03272
Epoch 18/300
19/19 - 23s - loss: 0.0379 - mae: 0.0383 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.02573 energy_within_threshold: 0.52357
INFO:megnet_models.callbacks:best mae: 0.03272 -> 0.02573
Epoch 19/300
19/19 - 24s - loss: 0.0286 - mae: 0.0285 - lr: 5.0000e-04 - 24s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.02396 energy_within_threshold: 0.52694
INFO:megnet_models.callbacks:best mae: 0.02573 -> 0.02396
Epoch 20/300
19/19 - 23s - loss: 0.0323 - mae: 0.0325 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.02697 energy_within_threshold: 0.52357
Epoch 21/300
19/19 - 23s - loss: 0.0305 - mae: 0.0306 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.03053 energy_within_threshold: 0.55724
Epoch 22/300
19/19 - 23s - loss: 0.0304 - mae: 0.0305 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.02719 energy_within_threshold: 0.54209
Epoch 23/300
19/19 - 23s - loss: 0.0291 - mae: 0.0292 - lr: 5.0000e-04 - 23s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.03803 energy_within_threshold: 0.27609
Epoch 24/300
19/19 - 24s - loss: 0.0276 - mae: 0.0276 - lr: 5.0000e-04 - 24s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.03357 energy_within_threshold: 0.33838
Epoch 25/300
19/19 - 24s - loss: 0.0313 - mae: 0.0313 - lr: 5.0000e-04 - 24s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.02719 energy_within_threshold: 0.44613
Epoch 26/300
19/19 - 24s - loss: 0.0294 - mae: 0.0295 - lr: 5.0000e-04 - 24s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.02609 energy_within_threshold: 0.52020
Epoch 27/300
19/19 - 24s - loss: 0.0252 - mae: 0.0251 - lr: 5.0000e-04 - 24s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.03020 energy_within_threshold: 0.29125
Epoch 28/300
19/19 - 24s - loss: 0.0269 - mae: 0.0270 - lr: 5.0000e-04 - 24s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.02252 energy_within_threshold: 0.67340
INFO:megnet_models.callbacks:best mae: 0.02396 -> 0.02252
Epoch 29/300
19/19 - 24s - loss: 0.0245 - mae: 0.0247 - lr: 5.0000e-04 - 24s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.03941 energy_within_threshold: 0.30808
Epoch 30/300
19/19 - 24s - loss: 0.0326 - mae: 0.0326 - lr: 5.0000e-04 - 24s/epoch - 1s/step
INFO:megnet_models.callbacks:val mae: 0.03339 energy_within_threshold: 0.29125
Epoch 31/300
19/19 - 24s - loss: 0.0343 - mae: 0.0339 - lr: 5.0000e-04 - 24s/epoch - 1s/step
