# IDAO 2022 Qualifying round
**TEAM: Baseline**
- Leader: Hiroshi Yoshihara (Kyoto University / https://github.com/analokmaus)
- Member: Takumi Futamata (HSE / https://github.com/TakumiJapan)
- Member: Satoshi Nakamura (HSE)

## 0. Set up environment
```
conda create -n idao2022 --file environment.yaml
conda activate idao2022
```

## 1. Download dataset
Place competition dataset and [pretrained model weights](https://github.com/materialsvirtuallab/megnet/tree/master/mvl_models/mp-2019.4.1) to `data/` folder.
```
┣ data
┃   ┣ dichalcogenides_private
┃   ┃   ┣ structures/...
┃   ┣ dichalcogenides_public
┃   ┃   ┣ structures/...
┃   ┃   ┣ targets.csv
┃   ┣ efermi.hdf5
┃   ┣ efermi.hdf5.json
┃
┣ exp24e.py
┣ ...
```

## 2. Prepare dataset cache to speed up training
```
python preprocess.py --cutoff 5 # -> data/data_cache_cutoff5.pickle will be created
```

## 3. Run training script
Our best submission (**Public 0.936 / Private 0.939 / 1st Place**) is generated by `exp24e.py`. 
The neural network was trained on a GF RTX 3090.
```
python exp24e.py # -> log and model weight etc will be exported to results/exp_24_e
```

### 3-1. Track 1
Submission is located at `results/exp_24_e/submission.csv`.

### 3-2. Track 2
Copy and paste from `results/exp_24_e/checkpoint.hdf5` to `track2/results/exp_24_e.hdf5`.
Zip the content of `track2/`.
